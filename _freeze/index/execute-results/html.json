{
  "hash": "e5fe48540fc9797884426f21d758464b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Game Metrics: Decoding Premier League Outcomes Through Visual Analysis and Data Exploration\"\nsubtitle: \"INFO 526 - Project 1\"\nauthor: \"Group 4 WackyWednesday\"\nformat: html\neditor: visual\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n## Abstract\n\n*Add project abstract here; delete this text when done*\n\n## Introduction\n\n*Add introduction here; delete this text when done*\n\n## Question 1\n\n*Intro goes here; delete this text when done*\n\n### Approach\n\n*Approach goes here; delete this text when done*\n\n### Analysis\n\n*Analysis goes here; delete this text when done*\n\n### Discussion\n\n*Discussion goes here; delete this text when done*\n\n\n## Question 2\n\n*Intro goes here; delete this text when done*\n\n### Approach\n\n*Approach goes here; delete this text when done*\n\n### Analysis\n\n*Analysis goes here; delete this text when done*\n\n#### Penalties by Team\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nq2_penalties_viz <- soccer |> \n  rename(\n    yellow_home = HY, yellow_away = AY,\n    red_home = HR, red_away = AR,\n    foul_home = HF, foul_away = AF\n  ) |> \n  select(\n    yellow_home, yellow_away,\n    red_home, red_away,\n    foul_home, foul_away\n  ) |> \n  mutate(game_number = row_number()) |> \n  group_by(game_number) |> \n  pivot_longer(\n    cols = c(yellow_home, red_home,\n             yellow_away, red_away,\n             foul_away, foul_home),\n    names_to = \"pen_type\",\n    values_to = \"pen_count\"\n  ) |> \n  mutate(\n    pen_cat = case_when(\n      str_detect(pen_type, \"yellow\") ~ \"yellow\",\n      str_detect(pen_type, \"red\") ~ \"red\",\n      str_detect(pen_type, \"foul\") ~ \"foul\"\n    ),\n    h_a = case_when(\n      str_detect(pen_type, \"home\") ~ \"Home\",\n      str_detect(pen_type, \"away\") ~ \"Away\"\n    )\n  ) |>\n  group_by(h_a, pen_count, pen_cat) |> \n  select(!pen_type) |> \n  summarize(tot = n()) |> \n  # filter(pen_count !=0) |>\n  mutate(\n    pen_cf = case_when(\n      pen_cat == \"foul\" ~ \"Fouls\",\n      TRUE ~ \"Cards\"\n    )\n  ) |> \n  ggplot(aes(x = pen_count,\n             y = tot,\n             group = pen_cat,\n             color = h_a)) +\n  facet_wrap(\n    ~ pen_cf,\n    ncol = 1,\n    scales = \"free\",\n    strip.position = \"right\"\n    # space=\"free\"\n  ) +\n  geom_line(\n    aes(group = interaction(pen_cat, h_a)),\n    linewidth = 1,\n    alpha = 0.5\n  ) +\n  geom_point(\n    aes(shape = h_a),\n    size = 3,\n    stroke = 1\n  ) +\n  # Annotations for Card facet\n  geom_text(\n    data = data.frame(\n      \"label\" = c(\"Red\", \"Yellow\"),\n      x = c(0.5, 1.5),\n      y = c(300, 150),\n      # x = c(1.5, 1.5),\n      # y = c(25, 125),\n      pen_cf = c(\"Cards\", \"Cards\")\n    ),\n    aes(x = x, y = y, group = 1, label=label),\n    color = \"black\",\n    family = \"mono\"\n  ) +\n  # Theme settings\n  scale_color_brewer(\n    palette = \"Set2\",\n    breaks = c(\"Home\", \"Away\")\n  ) +\n  scale_shape_manual(\n    breaks = c(\"Home\", \"Away\"),\n    values = c(3, 4)\n  ) +\n  theme_classic() +\n  theme(\n    text = element_text(family = \"mono\"),\n    legend.position = \"inside\",\n    legend.position.inside = c(0.9, 0.9),\n    legend.box.background = element_rect(),\n    plot.title.position = \"plot\"\n  ) +\n  labs(\n    title = \"Number of football games by amounts of penalties\",\n    x = \"Total penalties in a game\",\n    y = \"Number of games\",\n    color = \"Team\",\n    shape = \"Team\",\n    subtitle = \"Premier League match data, 2021-2022\"\n  )\n\nq2_penalties_viz\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/q2_penalties-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n#### Cards:Fouls Ratio by Team\n\n*code goes here; delete when done*\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsoccer\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 380 × 22\n   Date     HomeTeam AwayTeam  FTHG  FTAG FTR    HTHG  HTAG HTR  \n   <chr>    <chr>    <chr>    <dbl> <dbl> <chr> <dbl> <dbl> <chr>\n 1 13/08/2… Brentfo… Arsenal      2     0 H         1     0 H    \n 2 14/08/2… Man Uni… Leeds        5     1 H         1     0 H    \n 3 14/08/2… Burnley  Brighton     1     2 A         1     0 H    \n 4 14/08/2… Chelsea  Crystal…     3     0 H         2     0 H    \n 5 14/08/2… Everton  Southam…     3     1 H         0     1 A    \n 6 14/08/2… Leicest… Wolves       1     0 H         1     0 H    \n 7 14/08/2… Watford  Aston V…     3     2 H         2     0 H    \n 8 14/08/2… Norwich  Liverpo…     0     3 A         0     1 A    \n 9 15/08/2… Newcast… West Ham     2     4 A         2     1 H    \n10 15/08/2… Tottenh… Man City     1     0 H         0     0 D    \n# ℹ 370 more rows\n# ℹ 13 more variables: Referee <chr>, HS <dbl>, AS <dbl>,\n#   HST <dbl>, AST <dbl>, HF <dbl>, AF <dbl>, HC <dbl>,\n#   AC <dbl>, HY <dbl>, AY <dbl>, HR <dbl>, AR <dbl>\n```\n\n\n:::\n:::\n\n\n\n### Discussion\n\n*Discussion goes here; delete this text when done*\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}